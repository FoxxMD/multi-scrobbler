"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["3693"],{39167:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>t,default:()=>h,toc:()=>c,metadata:()=>r,assets:()=>o,contentTitle:()=>l});var r=JSON.parse('{"id":"configuration/transforms/user","title":"User Stage","description":"The User Stage uses search-and-replace expressions, provided by you, to modify/replace parts of Play data.","source":"@site/docs/configuration/transforms/user.mdx","sourceDirName":"configuration/transforms","slug":"/configuration/transforms/user","permalink":"/multi-scrobbler/configuration/transforms/user","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/configuration/transforms/user.mdx","tags":[],"version":"current","frontMatter":{"title":"User Stage","toc_min_heading_level":2,"toc_max_heading_level":5},"sidebar":"tutorialSidebar","previous":{"title":"Native Stage","permalink":"/multi-scrobbler/configuration/transforms/native"},"next":{"title":"Development","permalink":"/multi-scrobbler/category/development"}}'),i=s(85893),a=s(50065);let t={title:"User Stage",toc_min_heading_level:2,toc_max_heading_level:5},l=void 0,o={},c=[{value:"Configuration",id:"configuration",level:2},{value:"Default Stage",id:"default-stage",level:4},{value:"Search-And-Replace Expression",id:"search-and-replace-expression",level:3},{value:"Rules",id:"rules",level:3},{value:"Examples",id:"examples",level:2},{value:"Usage with <code>when</code> condition",id:"usage-with-when-condition",level:3},{value:"Remove phrase from Title in all new Plays",id:"remove-phrase-from-title-in-all-new-plays",level:3},{value:"Remove all parenthesized content from the end of a title",id:"remove-all-parenthesized-content-from-the-end-of-a-title",level:3},{value:"Rename misspelled artist in all new Plays",id:"rename-misspelled-artist-in-all-new-plays",level:3},{value:"Remove &quot;Various Artists&quot; albums in all new Plays",id:"remove-various-artists-albums-in-all-new-plays",level:3},{value:"Extract primary Artist from delimited, multi-Artist string",id:"extract-primary-artist-from-delimited-multi-artist-string",level:3}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components},{Details:s}=n;return s||function(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"User"})," ",(0,i.jsx)(n.a,{href:"/configuration/transforms#stage",children:"Stage"})," uses ",(0,i.jsxs)(n.a,{href:"#search-and-replace-expression",children:[(0,i.jsx)(n.strong,{children:"search-and-replace"})," expressions"]}),", provided by you, to modify/replace parts of Play data."]}),"\n",(0,i.jsx)(n.p,{children:"This Stage is most useful for correcting individual instances of bad data, or patterns, in your known data. Example scenarios:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Removing ",(0,i.jsx)(n.code,{children:"(Album Version)"})," from all Titles"]}),"\n",(0,i.jsxs)(n.li,{children:["Removing ",(0,i.jsx)(n.code,{children:"Various Artists"})," from Artist data"]}),"\n",(0,i.jsx)(n.li,{children:"Correcting spelling mistakes for individual Artist names"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The user ",(0,i.jsxs)(n.a,{href:"/configuration/transforms#stage",children:["Stage ",(0,i.jsx)(n.code,{children:"type"})]})," is ",(0,i.jsx)(n.code,{children:"user"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["All ",(0,i.jsx)(n.a,{href:"/configuration/transforms#configuring-stage",children:"Stage Configuration"})," is done using ",(0,i.jsxs)(n.a,{href:"#search-and-replace-expression",children:[(0,i.jsx)(n.strong,{children:"search-and-replace"})," expressions"]})," inside individual ",(0,i.jsx)(n.a,{href:"#rules",children:"rules"}),". Default configuration for all Rules can still be done using Stage ",(0,i.jsx)(n.code,{children:"defaults"}),"."]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Example"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",metastring:'title="config.json"',children:'{\n  // ...\n  "transformers": [\n    {\n      "type": "user",\n      "name": "Normalizer",\n      "defaults": {\n        "title": [\n          "(Album Version)"\n        ],\n        "artists": [\n            "Various Artists"\n        ]\n      }\n    }\n  ]\n}\n'})})]}),"\n",(0,i.jsx)(n.h4,{id:"default-stage",children:"Default Stage"}),"\n",(0,i.jsxs)(n.p,{children:["For your convenience, if you do not define any User ",(0,i.jsx)(n.a,{href:"/configuration/transforms#configuration",children:"Stage Configurations"})," then multi-scrobbler automatically builds an empty one for you."]}),"\n",(0,i.jsxs)(n.p,{children:["This can be used by omitting the ",(0,i.jsx)(n.code,{children:"name"})," in your ",(0,i.jsx)(n.a,{href:"/configuration/transforms#modification-stage",children:"modification Stage"}),"."]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Example"}),(0,i.jsxs)(n.p,{children:["In a ",(0,i.jsx)(n.a,{href:"/configuration/sources/subsonic",children:"Subsonic"})," ",(0,i.jsx)(n.a,{href:"/configuration?configType=file#configuration-types",children:"File Config"}),":"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",metastring:'title="subsonic.json"',children:'[\n  { \n    "name": "MySubsonic",\n    "data": { /* ... */},\n    "options": {\n      "playTransform": {\n        "preCompare": [\n          {\n            "type": "user",\n            // do not include name, the default user stage will be used\n            "title": [\n                // removes badterm from track title\n                "badterm"\n            ]\n          }\n        ]\n      }\n    }\n  }\n]\n'})})]}),"\n",(0,i.jsx)(n.h3,{id:"search-and-replace-expression",children:"Search-And-Replace Expression"}),"\n",(0,i.jsx)(n.p,{children:"A Search-And-Replace Expression can be a plain string that matches a literal, then removes it:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Expression: "badTerm"\n\n"this is badTerm cool string" => "this is a cool string"\n'})}),"\n",(0,i.jsx)(n.p,{children:"or a regular expression that matches and removes the match:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Expression: "/bad\\w+/i"\n\n"this is badSomething cool string" => "this is a cool string"\n'})}),"\n",(0,i.jsx)(n.p,{children:"Or it may be an object that specifies what to match (using either plain string or regular expression) and what to replace it with:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n    "search": "anotherBadTerm", // match all instances of \'anotherBadTerm\'\n    "replace": "goodTerm" // replace with the string \'goodTerm\'\n}\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'"this is anotherBadTerm cool string" => "this is goodTerm cool string"\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n    "search": "/^\\(\\w+.com)/i", // matches any string that starts with EX \'(YourMusic.com)\'\n    "replace": "[MySite.com]" // replace with the string \'[MySite.com]\'\n}\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'"(Foo.com) this is a cool string" => "[MySite.com] this is a cool string"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"replace"})," property uses javascript's ",(0,i.jsxs)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#specifying_a_string_as_the_replacement",children:[(0,i.jsx)(n.code,{children:"replace()"})," function and so can use any special string characters."]})]}),"\n",(0,i.jsx)(n.h3,{id:"rules",children:"Rules"}),"\n",(0,i.jsxs)(n.p,{children:["Each ",(0,i.jsx)(n.a,{href:"/configuration/transforms#stage-rules",children:"Rule"})," must be an array of ",(0,i.jsx)(n.a,{href:"#search-and-replace-expressions",children:"search-and-replace expressions"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",metastring:'title="lastfm.json"',children:'[\n  {\n    "name": "myLastFm",\n    "configureAs": "source",\n    "data": {\n      // ...\n    },\n    "options": {\n      "playTransform": {\n        "type": "user",\n        "preCompare": [\n            {\n                "title": [\n                    // removes "badTerm" from title\n                    "badTerm",\n                    {\n                        // removes "fooTerm" from title and replaces it with "barTerm"\n                        "search": "fooTerm",\n                        "replace": "barTerm"\n                    }\n                ]\n            }\n        ],\n      }\n    }\n  }\n]\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["If the value of the field (title, an artist, album) is an empty string after transforming then the field is ",(0,i.jsx)(n.strong,{children:"removed."})]})}),"\n",(0,i.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsxs)(n.h3,{id:"usage-with-when-condition",children:["Usage with ",(0,i.jsx)(n.code,{children:"when"})," condition"]}),"\n",(0,i.jsxs)(n.p,{children:["Using ",(0,i.jsx)(n.code,{children:"when"})," for ",(0,i.jsx)(n.a,{href:"/configuration/transforms#conditional-modification",children:"Conditional Modification"})]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Example"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'//   On search-replace in title...\n//     IF artist matches "Elephant Gym"\n//     THEN Run regex search-replace ELSE skip this rule\n//\n//   Run live|remastered regex remove on title\n{\n    "title": [\n        {\n            "search": "/\\\\s\\\\-\\\\s\u6EFE\u77F340\\\\s\u6EFE\u77F3\u649E\u6A02\u968A\\\\s40\u5718\u62DA\u7D93\u5178(.+)$/i",\n            "replace": "",\n            "when": [\n                {\n                    "artist": "/Elephant Gym/"\n                }\n            ]\n        },\n        "/(\\\\s\\\\-\\\\s|\\\\s)(feat\\\\.(.+)|live|remastered(.+))$/i"\n    ],\n}\n'})})]}),"\n",(0,i.jsx)(n.h3,{id:"remove-phrase-from-title-in-all-new-plays",children:"Remove phrase from Title in all new Plays"}),"\n",(0,i.jsxs)(n.p,{children:["Removes the phrase ",(0,i.jsx)(n.code,{children:"(Album Version)"})," from the Title of a Play"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Example"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n    "title": [\n        "(Album Version)"\n    ]\n}\n\n'})})]}),"\n",(0,i.jsx)(n.h3,{id:"remove-all-parenthesized-content-from-the-end-of-a-title",children:"Remove all parenthesized content from the end of a title"}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Example"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n"compare": {\n        "candidate": {\n            "title": [\n                "/(\\(.+\\))\\s*$/"\n            ]\n        },\n        "existing": {\n            "title": [\n                "/(\\(.+\\))\\s*$/"\n            ]\n        },\n    },\n}\n'})})]}),"\n",(0,i.jsx)(n.h3,{id:"rename-misspelled-artist-in-all-new-plays",children:"Rename misspelled artist in all new Plays"}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Example"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n    "artists": [\n        {\n        "search": "Boz Skaggs",\n        "replace": "Boz Scaggs"\n        }\n    ]\n}\n'})})]}),"\n",(0,i.jsx)(n.h3,{id:"remove-various-artists-albums-in-all-new-plays",children:'Remove "Various Artists" albums in all new Plays'}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Example"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n    "album": [\n        {\n        "search": "Various Artists",\n        "replace": ""\n        }\n    ]\n}\n'})})]}),"\n",(0,i.jsx)(n.h3,{id:"extract-primary-artist-from-delimited-multi-artist-string",children:"Extract primary Artist from delimited, multi-Artist string"}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)(n.p,{children:"When the Artist string is actually a multi-artist, delimited string, this search-and-replace will replace the string with just the first artist found."}),(0,i.jsx)(n.p,{children:"Ex"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"My Artist One / My Artist Two / Another Guy\nMy Artist One\n"})}),(0,i.jsxs)(n.p,{children:["Artists are delimited with a spaced forward slash (",(0,i.jsx)(n.code,{children:"/"}),") in the regex below. Replace the contents of the ",(0,i.jsx)(n.code,{children:"delim"})," capture group with the delimiter for your use case. Some more common scenarios:"]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"(?<delim>\\\\/)"})," No spaces between slash IE ",(0,i.jsx)(n.code,{children:"My Artist One/My Artist Two/Another Guy"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"(?<delim>\\\\s*\\\\\\\\\\s*)"})," Backslash instead of forward slash IE ",(0,i.jsx)(n.code,{children:"My Artist One \\ My Artist Two \\ Another Guy"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"(?<delim>,)"})," Comma IE ",(0,i.jsx)(n.code,{children:"My Artist One, My Artist Two, Another Guy"})]}),"\n"]}),(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Example"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "artists": [\n        {\n            "search": "(.*?)(?<delim>\\\\s*\\\\/\\\\s*)(.*$)",\n            "replace": "$1"\n        }\n    ]\n}\n'})})]})]})]})}function h(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);