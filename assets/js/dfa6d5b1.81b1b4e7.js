"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["7416"],{42302:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>o,default:()=>h,toc:()=>c,metadata:()=>i,assets:()=>l,contentTitle:()=>a});var i=JSON.parse('{"id":"configuration/transforms/native","title":"Native Stage","description":"The Native Stage uses built-in heuristics to try to extract Artists from Play artist/track data.","source":"@site/docs/configuration/transforms/native.mdx","sourceDirName":"configuration/transforms","slug":"/configuration/transforms/native","permalink":"/multi-scrobbler/configuration/transforms/native","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/configuration/transforms/native.mdx","tags":[],"version":"current","frontMatter":{"title":"Native Stage","toc_min_heading_level":2,"toc_max_heading_level":5},"sidebar":"tutorialSidebar","previous":{"title":"Musicbrainz Stage","permalink":"/multi-scrobbler/configuration/transforms/musicbrainz"},"next":{"title":"User Stage","permalink":"/multi-scrobbler/configuration/transforms/user"}}'),t=s(85893),r=s(50065);let o={title:"Native Stage",toc_min_heading_level:2,toc_max_heading_level:5},a=void 0,l={},c=[{value:"Configuration",id:"configuration",level:2},{value:"Rules",id:"rules",level:3},{value:"Default Stage",id:"default-stage",level:3},{value:"ENV Configuration",id:"env-configuration",level:2},{value:"Examples",id:"examples",level:2},{value:"Parse only artists string using a custom delimiter",id:"parse-only-artists-string-using-a-custom-delimiter",level:3},{value:"Don&#39;t parse specific artists",id:"dont-parse-specific-artists",level:3},{value:"Extract Artists from Title but do not modify Title",id:"extract-artists-from-title-but-do-not-modify-title",level:3}];function d(e){let n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components},{Details:s}=n;return s||function(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"Native"})," ",(0,t.jsx)(n.a,{href:"/configuration/transforms#stage",children:"Stage"})," uses ",(0,t.jsx)(n.a,{href:"https://github.com/FoxxMD/multi-scrobbler/blob/master/src/backend/tests/plays/playParsing.test.ts",children:"built-in heuristics"})," to try to extract Artists from Play artist/track data."]}),"\n",(0,t.jsx)(n.p,{children:"This Stage is most useful for Sources that report limited data such as:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/configuration/sources/subsonic",children:"Subsonic"})," - Reports Artists as a single string"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"A non-exhaustive list of heuristics:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Splits artists in artist string using common delimiters EX ",(0,t.jsx)(n.code,{children:"Foo Artist, Bar Guy, Baz Band - My Cool Song"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Does not split artists with ",(0,t.jsx)(n.code,{children:"&"})," in name, if other delimiters are present"]}),"\n",(0,t.jsx)(n.li,{children:"Does not split artist name when only one delimiter is present"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Splits artists on common joiner phrases (ft. feat. vs. etc...)","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Extracts artists from Play title using joiner phrases EX ",(0,t.jsx)(n.code,{children:"My Cool Song (feat. SomeGuy)"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"A practical example of what the Native Stage will do to Play data:"}),"\n",(0,t.jsxs)(n.p,{children:["This Scrobble from ",(0,t.jsx)(n.a,{href:"/configuration/sources/subsonic",children:"Subsonic"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "title": "Endless Possibility (feat. Wheatus)",\n    "artists": ["Bowling For Soup & Punk Rock Factory"]\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Will be transformed into this"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "title": "Endless Possibility",\n    "artists": ["Bowling For Soup", "Punk Rock Factory", "Wheatus"]\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Available properties for ",(0,t.jsx)(n.a,{href:"/configuration/transforms#configuring-stages",children:"Stage Configuration"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"delimitersExtra"})," - A list of string characters that should be considered delimiters for artists ",(0,t.jsx)(n.strong,{children:"in addition to"})," multi-scrobbler's default list (",(0,t.jsx)(n.code,{children:",  /   \\ "}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"delimiters"})," - A list of string characters that should be considered delimiters for artists.","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Replaces"})," all delimiters (MS not use any defaults, only what you give it)"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"artistsIgnore"})," - a list of strings and/or regular expressions. Any monolothic artist string that matches from the list ",(0,t.jsx)(n.em,{children:"will not be modified."})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"artistsParseFrom"})," a list of the properties that should be used to try to extract artists. Can be ",(0,t.jsx)(n.code,{children:"artists"})," ",(0,t.jsx)(n.code,{children:"title"})," or both. Defaults to both when not provided in options ( ",(0,t.jsx)(n.code,{children:'["artists", "title"]'})," )","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["When ",(0,t.jsx)(n.code,{children:"artists"})," is present it tries to extract additional artists from artist strings"]}),"\n",(0,t.jsxs)(n.li,{children:["When ",(0,t.jsx)(n.code,{children:"title"})," is present it tries to extract artists from ft. feat. vs. etc... found in the track title"]}),"\n",(0,t.jsxs)(n.li,{children:["Importantly, if ",(0,t.jsx)(n.code,{children:"artists"})," is ",(0,t.jsx)(n.em,{children:"not"})," present in ",(0,t.jsx)(n.code,{children:"artistsParseFrom"})," then ",(0,t.jsx)(n.em,{children:"no artists"})," are used at all (only those from ",(0,t.jsx)(n.code,{children:"title"}),", if present)"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"artistsParseMonolithicOnly"})," - boolean value, defaults to ",(0,t.jsx)(n.code,{children:"true"}),". When ",(0,t.jsx)(n.code,{children:"true"})," native tranformer will only attempt to extract artists if the scrobble data has ",(0,t.jsx)(n.em,{children:"only one string for artist"})," (pre-transform)","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["This means that, for Sources like Spotify/Jellyfin/etc. that provide proper lists of artists in their data ",(0,t.jsx)(n.em,{children:"and the list has more than one string"}),", it will not try to extract artists from their strings"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsxs)("summary",{children:["Example of the behavior for ",(0,t.jsx)(n.code,{children:"artistsParseFrom"})]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"The Foos, The Bars - My Cool Track (ft. Frank)\n"})}),(0,t.jsx)(n.p,{children:"Config => extracted artists"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'"artistsParseFrom": ["artists", "title"]        => The Foos, The Bars, Frank\n"artistsParseFrom": ["artists"]                 => The Foos, The Bars\n"artistsParseFrom": ["title"]                   => Frank\n"artistsParseFrom": []                          =>\n'})})]}),"\n",(0,t.jsx)(n.h3,{id:"rules",children:"Rules"}),"\n",(0,t.jsxs)(n.p,{children:["Each ",(0,t.jsx)(n.a,{href:"/configuration/transforms#stage-rules",children:"Rule"})," should be either a boolean, specifying if the transformed data should be used for this field, or a ",(0,t.jsxs)(n.a,{href:"/configuration/transforms#conditional-moditication",children:[(0,t.jsx)(n.code,{children:"when"})," condition."]}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json5",children:'{\n    "type": "native",\n    // ...\n    "title": false, // will not apply any changes to Play title\n    "artists": {\n      "when": {/* ... */}, // will only apply changes to Play artists if "when" is satisfied\n    /* ... */\n    },\n    "album": true // will always apply changes to Play album\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["If a rule is not present then multi-scrobbler defaults it to ",(0,t.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"default-stage",children:"Default Stage"}),"\n",(0,t.jsxs)(n.p,{children:["For your convenience, if you do not define any Native ",(0,t.jsx)(n.a,{href:"/configuration/transforms#configuring-stages",children:"Stage Configurations"})," then multi-scrobbler automatically builds one using the defaults shown in ",(0,t.jsx)(n.a,{href:"#configuration",children:"configuration"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["This can be used by omitting the ",(0,t.jsx)(n.code,{children:"name"})," in your ",(0,t.jsx)(n.a,{href:"/configuration/transforms#modification-stage",children:"modification Stage"}),"."]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Example"}),(0,t.jsxs)(n.p,{children:["In a ",(0,t.jsx)(n.a,{href:"/configuration/sources/subsonic",children:"Subsonic"})," ",(0,t.jsx)(n.a,{href:"/configuration?configType=file#configuration-types",children:"File Config"}),":"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json5",metastring:'title="subsonic.json"',children:'[\n  { \n    "name": "MySubsonic",\n    "data": { /* ... */},\n    "options": {\n      "playTransform": {\n        "preCompare": [\n          {\n            "type": "native",\n            // do not include name, the default native stage will be used\n          }\n        ]\n      }\n    }\n  }\n]\n'})})]}),"\n",(0,t.jsx)(n.h2,{id:"env-configuration",children:"ENV Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["The default configuration shown above can also be applied using ",(0,t.jsx)(n.a,{href:"/configuration?configType=env#configuration-types",children:"ENV Config"})," for individual Sources/Clients."]}),"\n",(0,t.jsxs)(n.p,{children:["Use ENV ",(0,t.jsx)(n.code,{children:"*_TRANSFORMS=native"})," on each Source/Client you wish to apply this stage to. This applies the stage in the ",(0,t.jsxs)(n.a,{href:"/configuration/transforms#lifecycle-hooks",children:[(0,t.jsx)(n.code,{children:"preTransform"})," Hook"]})," with all ",(0,t.jsx)(n.a,{href:"#rules",children:"Rules"})," enabled."]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"*"})," stands for the prefix used for each Source/Client's ENV keys. Refer to the individual Source/Client Configuration sections to find this. Example"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["All ",(0,t.jsx)(n.a,{href:"http://localhost:3000/docs/configuration/sources/subsonic/",children:"Subsonic Source"})," ENVs look like ",(0,t.jsx)(n.code,{children:"SUBSONIC_USER=myuser"})," etc..."]}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.code,{children:"SUBSONIC_TRANSFORMS=native"})]}),"\n"]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Example Full Docker Deploy with ENV Configuration"}),(0,t.jsxs)(n.p,{children:["Using ",(0,t.jsx)(n.a,{href:"/quickstart#create-docker-compose-file",children:"Jellyfin + Maloja"})," example from Quickstart:"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'services:\n  multi-scrobbler:\n    image: foxxmd/multi-scrobbler\n    container_name: multi-scrobbler\n    environment:\n      - JELLYFIN_URL=192.168.0.110:8096\n      - JELLYFIN_APIKEY=c9fae8756fbf481ebd9c5bb56b\n      - JELLYFIN_USER=MyUser\n      - JELLYFIN_TRANSFORMS=native # applies native Stage to preTransform of Jellyfin source\n\n      - MALOJA_URL=http://192.168.0.100:42010 # maloja receives enhanced scrobble from Jellyfin\n      - MALOJA_API_KEY=myApiKey\n\n\n    volumes:\n      - "./config:/config"\n    ports:\n      - "9078:9078"\n    restart: unless-stopped\n'})})]}),"\n",(0,t.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(n.h3,{id:"parse-only-artists-string-using-a-custom-delimiter",children:"Parse only artists string using a custom delimiter"}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Example"}),(0,t.jsxs)(n.p,{children:["Your ",(0,t.jsx)(n.a,{href:"/configuration?configType=aio#configuration-types",children:"AIO Config"}),":"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json5",metastring:'title="config.json"',children:'{\n  // ...\n  "transformers": [\n    {\n      "type": "native",\n      "name": "MyNativeTransformer",\n      "defaults": {\n        // default delimiters when this Stage is used in a hook\n        "delimiters": [\n          "\u2022"\n        ],\n        // default delimiters when this Stage is used in a hook\n        "artistsParseFrom": ["artists"]\n      }\n    }\n  ]\n}\n'})}),(0,t.jsxs)(n.p,{children:["In a ",(0,t.jsx)(n.a,{href:"/configuration/sources/subsonic",children:"Subsonic"})," ",(0,t.jsx)(n.a,{href:"/configuration?configType=file#configuration-types",children:"File Config"}),":"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json5",metastring:'title="subsonic.json"',children:'[\n  { \n    "name": "MySubsonic",\n    "data": { /* ... */},\n    "options": {\n      "playTransform": {\n        "preCompare": [\n          {\n            "type": "native",\n            "name": "MyNativeTransformer"\n          }\n        ]\n      }\n    }\n  }\n]\n'})})]}),"\n",(0,t.jsx)(n.h3,{id:"dont-parse-specific-artists",children:"Don't parse specific artists"}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Example"}),(0,t.jsxs)(n.p,{children:["Your ",(0,t.jsx)(n.a,{href:"/configuration?configType=aio#configuration-types",children:"AIO Config"}),":"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json5",metastring:'title="config.json"',children:'{\n  // ...\n  "transformers": [\n    {\n      "type": "native",\n      "name": "MyNativeTransformer",\n      "defaults": {\n        "artistsIgnore": [\n            "Crosby, Stills, Nash & Young",\n            "Polo & Pan"\n        ]\n      }\n    }\n  ]\n}\n'})}),(0,t.jsxs)(n.p,{children:["In a ",(0,t.jsx)(n.a,{href:"/configuration/sources/subsonic",children:"Subsonic"})," ",(0,t.jsx)(n.a,{href:"/configuration?configType=file#configuration-types",children:"File Config"}),":"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json5",metastring:'title="subsonic.json"',children:'[\n  { \n    "name": "MySubsonic",\n    "data": { /* ... */},\n    "options": {\n      "playTransform": {\n        "preCompare": [\n          {\n            "type": "native",\n            "name": "MyNativeTransformer"\n          }\n        ]\n      }\n    }\n  }\n]\n'})})]}),"\n",(0,t.jsx)(n.h3,{id:"extract-artists-from-title-but-do-not-modify-title",children:"Extract Artists from Title but do not modify Title"}),"\n",(0,t.jsxs)(n.p,{children:["In the scenario where you want to extract Artists from Track titles with joiners like ",(0,t.jsx)(n.code,{children:"My Cool Track (feat. Foobar)"})," but want to keep the title as-is:"]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Example"}),(0,t.jsxs)(n.p,{children:["No additional ",(0,t.jsx)(n.a,{href:"#configuration",children:"stage configuration"})," is required so we can use the ",(0,t.jsx)(n.a,{href:"#default-stage",children:"default Stage"}),"."]}),(0,t.jsxs)(n.p,{children:["In a ",(0,t.jsx)(n.a,{href:"/configuration/sources/subsonic",children:"Subsonic"})," ",(0,t.jsx)(n.a,{href:"/configuration?configType=file#configuration-types",children:"File Config"}),":"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json5",metastring:'title="subsonic.json"',children:'[\n  { \n    "name": "MySubsonic",\n    "data": { /* ... */},\n    "options": {\n      "playTransform": {\n        "preCompare": [\n          {\n            "type": "native",\n            "title": false // do not modify title\n          }\n        ]\n      }\n    }\n  }\n]\n'})})]})]})}function h(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);