"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["3989"],{66833:function(e,t,i){i.r(t),i.d(t,{frontMatter:()=>a,default:()=>x,toc:()=>u,metadata:()=>r,assets:()=>d,contentTitle:()=>h});var r=JSON.parse('{"id":"configuration/sources/spotify","title":"Spotify","description":"If your Spotify player has Automix enabled and Spotify uses it for your playlist/queue then MS cannot accurately determine when a track will end. This is because the track is \\"mixed\\" in your queue with a shorter play time than its actual length and Spotify does not report this modified play time in its API. This does not affect MS\'s ability to scrobble from Spotify but it will affect the accuracy of the duration MS reports was played.","source":"@site/docs/configuration/sources/spotify.mdx","sourceDirName":"configuration/sources","slug":"/configuration/sources/spotify","permalink":"/multi-scrobbler/configuration/sources/spotify","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/configuration/sources/spotify.mdx","tags":[],"version":"current","frontMatter":{"title":"Spotify","toc_min_heading_level":2,"toc_max_heading_level":5},"sidebar":"tutorialSidebar","previous":{"title":"Rocksky","permalink":"/multi-scrobbler/configuration/sources/rocksky-source"},"next":{"title":"Subsonic","permalink":"/multi-scrobbler/configuration/sources/subsonic"}}'),s=i(85893),o=i(50065),n=i(703),c=i(73752);i(75752);var l=i(51952);i(21863);let a={title:"Spotify",toc_min_heading_level:2,toc_max_heading_level:5},h=void 0,d={},u=[{value:"Authenticate Spotify with Multi-Scrobbler",id:"authenticate-spotify-with-multi-scrobbler",level:4},{value:"Configuration",id:"configuration",level:2}];function p(e){let t={a:"a",code:"code",h2:"h2",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.a)(),...e.components},{Config:r,Details:a,DetailsAdmo:h}=t;return r||f("Config",!0),a||f("Details",!0),h||f("DetailsAdmo",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h,{type:"note",summary:"Spotify and Automix",children:(0,s.jsxs)(t.p,{children:["If your Spotify player has ",(0,s.jsx)(t.a,{href:"https://community.spotify.com/t5/FAQs/What-is-Automix/ta-p/5257278",children:"Automix"}),' enabled and Spotify uses it for your playlist/queue then MS cannot accurately determine when a track will end. This is because the track is "mixed" in your queue with a shorter play time than its actual length and ',(0,s.jsx)(t.a,{href:"https://community.spotify.com/t5/Spotify-for-Developers/Wrong-duration-ms-of-track-with-Automix/m-p/5429147",children:"Spotify does not report this modified play time in its API."})," This ",(0,s.jsx)(t.strong,{children:"does not affect MS's ability to scrobble"})," from Spotify but it will affect the accuracy of the duration MS reports was played."]})}),"\n",(0,s.jsx)(t.h4,{id:"authenticate-spotify-with-multi-scrobbler",children:"Authenticate Spotify with Multi-Scrobbler"}),"\n",(0,s.jsxs)(t.p,{children:["To access your Spotify history you must ",(0,s.jsx)(t.a,{href:"https://developer.spotify.com/dashboard",children:"create a Spotify App"})," to get a\nClient ID/Secret."]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsxs)(t.strong,{children:["Login to ",(0,s.jsx)(t.a,{href:"https://developer.spotify.com",children:"https://developer.spotify.com"})]})," with your existing Spotify account and accept Developer Terms"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Navigate to your Spotify Developer ",(0,s.jsx)(t.a,{href:"https://developer.spotify.com/dashboard",children:"Dashboard"})," and start the ",(0,s.jsx)(t.strong,{children:"Create App"})," process"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Determine the correct ",(0,s.jsx)(t.strong,{children:"Redirect URI"})," to use and set it in your App settings"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)("summary",{children:"Redirect URI Instructions"}),(0,s.jsxs)(t.p,{children:["A Redirect URI is the URL that Spotify will navigate your ",(0,s.jsx)(t.strong,{children:"browser"})," to after you complete authorization. The URL will contain the code necessary for multi-scrobbler to get a Spotify access token."]}),(0,s.jsxs)(t.p,{children:["Spotify ",(0,s.jsx)(t.a,{href:"https://developer.spotify.com/documentation/web-api/tutorials/migration-insecure-redirect-uri",children:(0,s.jsx)(t.strong,{children:"no longer allows insecure URIs"})})," (start with ",(0,s.jsx)(t.code,{children:"http://"}),") unless the address is ",(0,s.jsx)(t.code,{children:"127.0.0.1"})," -- so ",(0,s.jsx)(t.code,{children:"localhost"})," and internal IPs (",(0,s.jsx)(t.code,{children:"192.168.0.xxx"}),") no longer work."]}),(0,s.jsxs)(t.p,{children:["Use ",(0,s.jsx)(t.strong,{children:"one"})," of the following methods to specify a valid Redirect URI and complete Spotify authentication with multi-scrobbler:"]}),(0,s.jsxs)(n.default,{groupId:"spotifyRedirect",queryString:!0,children:[(0,s.jsxs)(c.default,{value:"https",label:"HTTPS",children:[(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Use a domain you control, with SSL certificates/HTTPS enabled, to create a valid redirect URI."})}),(0,s.jsxs)(t.p,{children:["For example, if you are already running multi-scrobbler behind a reverse proxy (nginx/traefik/caddy) at ",(0,s.jsx)(t.code,{children:"https://scrobbler.mydomain.com"})," then set the Spotify Redirect URI for your Spotify App, and multi-scrobbler ",(0,s.jsx)(t.code,{children:"SPOTIFY_REDIRECT_URI"})," ENV, to ",(0,s.jsx)(t.code,{children:"https://scrobbler.mydomain.com/callback"})]}),(0,s.jsxs)(t.p,{children:["Alternatively, if multi-scrobbler is not accessible behind your domain, then use the ",(0,s.jsx)(t.a,{href:"./?spotifyRedirect=echo",children:(0,s.jsx)(t.strong,{children:"Echo"})})," method with your own domain instead of 127.0.0.1."]})]}),(0,s.jsxs)(c.default,{value:"local",label:"Run MS Locally",children:[(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Run multi-scrobbler, configured for a Spotify Source, from the same machine as your browser in order to get credentials."})}),(0,s.jsxs)(t.p,{children:["In this scenario you can use ",(0,s.jsx)(t.code,{children:"http://127.0.0.1:9078/callback"})," as the Spotify Redirect URI and multi-scrobbler ",(0,s.jsx)(t.code,{children:"SPOTIFY_REDIRECT_URI"})," ENV."]}),(0,s.jsxs)(t.p,{children:["After completing authentication, copy the contents of local multi-scrobbler's ",(0,s.jsx)(t.a,{href:"/installation#storage",children:"configuration folder"})," to the final location of where multi-scrobbler will be run."]})]}),(0,s.jsxs)(c.default,{value:"echo",label:"Echo",children:[(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:'Use a docker container on the same machine your browser is on to "intercept" the callback URL from Spotify authentication, then manually finish the process by changing the domain to your multi-scrobbler instance.'})}),(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Create a container on the same machine as your browser using the ",(0,s.jsx)(t.a,{href:"https://github.com/mendhak/docker-http-https-echo",children:(0,s.jsx)(t.code,{children:"mendhak/http-https-echo:36"})})," image. This container runs a simple HTTP server that echos back any request it recieves."]}),"\n"]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"docker run --rm -p 127.0.0.1:5079:8080 mendhak/http-https-echo:36\n"})}),(0,s.jsxs)(t.ol,{start:"2",children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Set the Spotify Redirect URI and multi-scrobbler ",(0,s.jsx)(t.code,{children:"SPOTIFY_REDIRECT_URI"})," ENV as ",(0,s.jsx)(t.code,{children:"http://127.0.0.1:5079/callback"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["In ",(0,s.jsx)(t.a,{href:"#authenticate-spotify-with-multi-scrobbler",children:"Authenticate Spotify with Multi-Scrobbler"})," (outside these Redirect Instructions) go to ",(0,s.jsx)(t.strong,{children:"Step 4"})," and continue the instructions"]}),"\n"]}),"\n"]}),(0,s.jsxs)(t.p,{children:["Eventually, Spotify will redirect you to a web page with a URL like ",(0,s.jsx)(t.code,{children:"http://127.0.0.1:5079/callback?code=xxxxxx..."})]}),(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"echo",src:i(2538).Z+"",width:"560",height:"521"})}),(0,s.jsxs)(t.ol,{start:"4",children:["\n",(0,s.jsxs)(t.li,{children:["In the URL, replace ",(0,s.jsx)(t.code,{children:"127.0.0.1:5079"})," with the address/IP for your multi-scrobbler instance so the URL is similar to ",(0,s.jsx)(t.code,{children:"http://192.168.0.101:9078/callback?code=xxxxxx..."}),". Then navigate to this URL to complete authentication."]}),"\n"]})]}),(0,s.jsxs)(c.default,{value:"msEcho",label:"Echo from echo.multi-scrobbler.app",children:[(0,s.jsxs)(t.p,{children:["For your convenience, I run the ",(0,s.jsx)(t.a,{href:"https://github.com/mendhak/docker-http-https-echo",children:(0,s.jsx)(t.code,{children:"mendhak/http-https-echo:36"})})," container from the ",(0,s.jsx)(t.a,{href:"./?spotifyRedirect=echo",children:(0,s.jsx)(t.strong,{children:"Echo"})})," approach on a domain I, the multi-scrobbler developer ",(0,s.jsx)(t.a,{href:"https://github.com/FoxxMD",children:"FoxxMD"}),", control and self-host. Please be aware:"]}),(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["I ",(0,s.jsx)(t.strong,{children:"do not collect personal data"})," or any querystrings/data sent in requests to this site"]}),"\n",(0,s.jsxs)(t.li,{children:["It's ",(0,s.jsx)(t.strong,{children:"not possible"})," for me to use the code sent by Spotify to this URL without also having your Client ID/Secret"]}),"\n",(0,s.jsxs)(t.li,{children:["However, there is ",(0,s.jsx)(t.strong,{children:"always"})," risk involved with trusting a service you do not control. Evaluate the risk of using this site for yourself."]}),"\n"]}),(0,s.jsxs)(t.p,{children:["Use the ",(0,s.jsx)(t.a,{href:"./?spotifyRedirect=echo",children:(0,s.jsx)(t.strong,{children:"Echo"})})," approach, starting from ",(0,s.jsx)(t.strong,{children:"Step 2"}),", with ",(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.a,{href:"https://echo.multi-scrobbler.app/callback",children:"https://echo.multi-scrobbler.app/callback"})})," as Spotify Redirect URI and multi-scrobbler ",(0,s.jsx)(t.code,{children:"SPOTIFY_REDIRECT_URI"})," ENV."]})]})]})]}),"\n",(0,s.jsxs)(t.ol,{start:"4",children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Save your new App, then copy the Client ID/Secret from the App's Basic Information page."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Add the Client ID, Secret, and Redirect URI to the respective field/ENV in the ",(0,s.jsx)(t.a,{href:"#configuration",children:"configuration section below"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Start multi-scrobbler, then visit the Web Dashboard and click ",(0,s.jsx)(t.strong,{children:"(Re)authenticate"})," on the Spotify card to start the auth process"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(r,{config:"SpotifySourceConfig",fileContent:l.Z,name:"spotify",children:(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Environmental Variable"}),(0,s.jsx)(t.th,{children:"Required?"}),(0,s.jsx)(t.th,{children:"Default"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"SPOTIFY_CLIENT_ID"})}),(0,s.jsx)(t.td,{children:"Yes"}),(0,s.jsx)(t.td,{}),(0,s.jsx)(t.td,{})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"SPOTIFY_CLIENT_SECRET"})}),(0,s.jsx)(t.td,{children:"Yes"}),(0,s.jsx)(t.td,{}),(0,s.jsx)(t.td,{})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"SPOTIFY_REDIRECT_URI"})}),(0,s.jsx)(t.td,{children:"No"}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"http://localhost:9078/callback"})}),(0,s.jsxs)(t.td,{children:["URI must end in ",(0,s.jsx)(t.code,{children:"callback"})]})]})]})]})})]})}function x(e={}){let{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}function f(e,t){throw Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},21863:function(e,t,i){i.d(t,{Z:()=>s}),i(67294);var r=i(85893);function s(e){return(0,r.jsx)("svg",{viewBox:"0 0 16 16",...e,children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})})}},51952:function(e,t,i){i.d(t,{Z:()=>r});let r='[\n  {\n    "name": "MySpotify",\n    "enable": true,\n    "clients": [],\n    "data": {\n      "clientId": "a89cba1569901a0671d5a9875fed4be1",\n      "clientSecret": "ec42e09d5ae0ee0f0816ca151008412a",\n      "redirectUri": "http://localhost:9078/callback",\n      "interval": 60\n    }\n  }\n]\n'},2538:function(e,t,i){i.d(t,{Z:()=>r});let r=i.p+"assets/images/echo-08989f35a8e831d1991e0aa90d40d07a.png"}}]);