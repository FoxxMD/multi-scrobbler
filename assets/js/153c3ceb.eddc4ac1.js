"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[652],{8094:(e,t,l)=>{l.r(t),l.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>p,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var n=l(4848),a=l(8453);const r={toc_min_heading_level:2,toc_max_heading_level:5,sidebar_position:4,title:"Flatpak",description:"Building Flatpak App locally"},s=void 0,o={id:"development/flatpak",title:"Flatpak",description:"Building Flatpak App locally",source:"@site/docs/development/flatpak.md",sourceDirName:"development",slug:"/development/flatpak",permalink:"/multi-scrobbler/docs/development/flatpak",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/development/flatpak.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{toc_min_heading_level:2,toc_max_heading_level:5,sidebar_position:4,title:"Flatpak",description:"Building Flatpak App locally"},sidebar:"tutorialSidebar",previous:{title:"Client Development/Tutorial",permalink:"/multi-scrobbler/docs/development/dev-client"},next:{title:"FAQ",permalink:"/multi-scrobbler/docs/FAQ"}},i={},d=[{value:"Install Requirements",id:"install-requirements",level:2},{value:"Flatpak and flatpak-builder",id:"flatpak-and-flatpak-builder",level:3},{value:"flatpak-node-generator",id:"flatpak-node-generator",level:4},{value:"Update Project source",id:"update-project-source",level:2},{value:"Generate Sources and Build",id:"generate-sources-and-build",level:2},{value:"Use Setup Script",id:"use-setup-script",level:3},{value:"Manual Setup",id:"manual-setup",level:3},{value:"Use <code>flatpak-node-generator</code> to generate sources",id:"use-flatpak-node-generator-to-generate-sources",level:4},{value:"Build flatpak",id:"build-flatpak",level:4}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,a.R)(),...e.components},{Details:l}=t;return l||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.admonition,{type:"note",children:(0,n.jsxs)(t.p,{children:["These steps are for building the flatpak from source. If you want to install the application normally then ",(0,n.jsx)(t.a,{href:"/multi-scrobbler/docs/installation/#flatpak",children:"get it through flathub"})]})}),"\n",(0,n.jsxs)(t.p,{children:["The final build repo for the flathub version can be found at ",(0,n.jsx)(t.a,{href:"https://github.com/flathub/io.github.foxxmd.multiscrobbler",children:"flathub/io.github.foxxmd.multiscrobbler"})]}),"\n",(0,n.jsx)(t.h2,{id:"install-requirements",children:"Install Requirements"}),"\n",(0,n.jsx)(t.h3,{id:"flatpak-and-flatpak-builder",children:"Flatpak and flatpak-builder"}),"\n",(0,n.jsxs)(t.p,{children:["Install ",(0,n.jsx)(t.a,{href:"https://flatpak.org/setup/",children:"Flatpak"})]}),"\n",(0,n.jsxs)(t.p,{children:["Install ",(0,n.jsx)(t.a,{href:"https://docs.flatpak.org/en/latest/first-build.html#building-your-first-flatpak",children:"flatpak-builder"})]}),"\n",(0,n.jsx)(t.h4,{id:"flatpak-node-generator",children:(0,n.jsx)(t.a,{href:"https://github.com/flatpak/flatpak-builder-tools/tree/master/node",children:"flatpak-node-generator"})}),"\n",(0,n.jsxs)(t.p,{children:["Requires python 3.7+, ",(0,n.jsx)(t.a,{href:"https://pip.pypa.io/en/stable/",children:"pip"}),"/",(0,n.jsx)(t.a,{href:"https://pypa.github.io/pipx/",children:"pipx"})]}),"\n",(0,n.jsx)(t.h2,{id:"update-project-source",children:"Update Project source"}),"\n",(0,n.jsxs)(t.p,{children:["Set the ",(0,n.jsx)(t.code,{children:"branch"})," ",(0,n.jsx)(t.code,{children:"tag"})," or ",(0,n.jsx)(t.code,{children:"commit"})," to use for MS in the ",(0,n.jsx)(t.code,{children:"source"})," section of ",(0,n.jsx)(t.a,{href:"https://github.com/FoxxMD/multi-scrobbler/blob/master/flatpak/io.github.foxxmd.multiscrobbler.yml",children:(0,n.jsx)(t.code,{children:"io.github.foxxmd.multiscrobbler.yml"})})]}),"\n",(0,n.jsx)(t.h2,{id:"generate-sources-and-build",children:"Generate Sources and Build"}),"\n",(0,n.jsx)(t.h3,{id:"use-setup-script",children:"Use Setup Script"}),"\n",(0,n.jsx)(t.p,{children:"A convenience bash script is provided that automates generating offline sources and building the flatpak app for you. This is the recommend method to use."}),"\n",(0,n.jsxs)(t.p,{children:["Located in the project at ",(0,n.jsx)(t.a,{href:"https://github.com/FoxxMD/multi-scrobbler/blob/master/flatpak/setup.sh",children:(0,n.jsx)(t.code,{children:"flatpak/setup.sh"})}),", run it from the ",(0,n.jsx)(t.code,{children:"flatpak"})," directory with this syntax:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",children:"./setup.sh -o -b /path/to/flatpak/build/dir\n"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"Args:\n\n-o => Delete and overwrite any existing generated sources\n-b => The absolute path to the directory that should be used for flatpak build/artifacts. If not defined will use `CWD/build`\n-y => Proceed without confirming settings\n"})}),"\n",(0,n.jsx)(t.h3,{id:"manual-setup",children:"Manual Setup"}),"\n",(0,n.jsxs)(t.p,{children:["If you cannot use ",(0,n.jsx)(t.code,{children:"setup.sh"})," follow the below to manually generate sources and build the flatpak app:"]}),"\n",(0,n.jsxs)(l,{children:[(0,n.jsx)("summary",{children:"Instructions"}),(0,n.jsxs)(t.h4,{id:"use-flatpak-node-generator-to-generate-sources",children:["Use ",(0,n.jsx)(t.code,{children:"flatpak-node-generator"})," to generate sources"]}),(0,n.jsxs)(t.p,{children:["First, ",(0,n.jsxs)(t.a,{href:"https://github.com/flatpak/flatpak-builder-tools/issues/354#issuecomment-1478518442",children:["make sure ",(0,n.jsx)(t.code,{children:"node_modules"})," is deleted or empty"]})," for both the project and ",(0,n.jsx)(t.code,{children:"docsite"})," directories."]}),(0,n.jsx)(t.p,{children:"Then, from MS project root:"}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",metastring:'title="PROJECT_DIR"',children:"flatpak-node-generator npm package-lock.json\n"})}),(0,n.jsxs)(t.p,{children:["Move ",(0,n.jsx)(t.code,{children:"generated-sources.json"})," into ",(0,n.jsx)(t.code,{children:"PROJECT_DIR/flatpak"})," and rename ",(0,n.jsx)(t.code,{children:"generated-sources.0.json"})]}),(0,n.jsxs)(t.p,{children:["Then, generate ",(0,n.jsx)(t.code,{children:"docsite"})," sources:"]}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",metastring:'title="PROJECT_DIR"',children:"flatpak-node-generator npm docsite/package-lock.json\n"})}),(0,n.jsxs)(t.p,{children:["Move ",(0,n.jsx)(t.code,{children:"generated-sources.json"})," into ",(0,n.jsx)(t.code,{children:"PROJECT_DIR/flatpak"})," and rename ",(0,n.jsx)(t.code,{children:"generated-sources.1.json"})]}),(0,n.jsx)(t.h4,{id:"build-flatpak",children:"Build flatpak"}),(0,n.jsxs)(t.p,{children:["In the below command replace ",(0,n.jsx)(t.code,{children:"/home/yourUser/multi-scrobbler-flatpak"})," with a directory to use for storing flatpak build/artifacts."]}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",metastring:'title="PROJECT_DIR/flatpak"',children:"flatpak-builder --repo=/home/yourUser/multi-scrobbler-flatpak/repo --state-dir=/home/yourUser/multi-scrobbler-flatpak/state /home/yourUser/multi-scrobbler-flatpak/build io.github.foxxmd.multiscrobbler.yml --force-clean\n"})}),(0,n.jsx)(t.admonition,{type:"info",children:(0,n.jsxs)(t.p,{children:["Append ",(0,n.jsx)(t.code,{children:"--install --user"})," to the above command to have the app installed immediately."]})})]}),"\n",(0,n.jsx)(t.h1,{id:"run-app",children:"Run App"}),"\n",(0,n.jsxs)(t.p,{children:["If built with ",(0,n.jsx)(t.code,{children:"--install --user"})," (default when using ",(0,n.jsx)(t.code,{children:"setup.sh"}),") you can now run MS using the command"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",children:"flatpak run -u io.github.foxxmd.multiscrobbler\n"})})]})}function p(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8453:(e,t,l)=>{l.d(t,{R:()=>s,x:()=>o});var n=l(6540);const a={},r=n.createContext(a);function s(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);