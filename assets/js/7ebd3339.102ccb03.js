"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["5122"],{8385:function(e,o,s){s.r(o),s.d(o,{frontMatter:()=>c,default:()=>x,toc:()=>h,metadata:()=>n,assets:()=>a,contentTitle:()=>d});var n=JSON.parse('{"id":"configuration/sources/sonos","title":"Sonos","description":"Multi-scrobbler can use the Sonos local API to monitor what your Sonos system is playing.","source":"@site/docs/configuration/sources/sonos.mdx","sourceDirName":"configuration/sources","slug":"/configuration/sources/sonos","permalink":"/multi-scrobbler/configuration/sources/sonos","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/configuration/sources/sonos.mdx","tags":[],"version":"current","frontMatter":{"title":"Sonos","toc_min_heading_level":2,"toc_max_heading_level":5},"sidebar":"tutorialSidebar","previous":{"title":"Rocksky","permalink":"/multi-scrobbler/configuration/sources/rocksky-source"},"next":{"title":"Spotify","permalink":"/multi-scrobbler/configuration/sources/spotify"}}'),r=s(85893),t=s(50065),i=s(703),l=s(73752);s(75752);let c={title:"Sonos",toc_min_heading_level:2,toc_max_heading_level:5},d=void 0,a={},h=[{value:"Filtering Activity",id:"filtering-activity",level:3},{value:"Configuration",id:"configuration",level:2}];function u(e){let o={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...e.components},{Config:s,Details:n,DetailsAdmo:c}=o;return s||g("Config",!0),n||g("Details",!0),c||g("DetailsAdmo",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.p,{children:["Multi-scrobbler can use the ",(0,r.jsx)(o.a,{href:"https://www.sonos.com",children:"Sonos"})," ",(0,r.jsx)(o.a,{href:"https://docs.sonos.com/docs/control",children:"local API"})," to monitor what your Sonos system is playing."]}),"\n",(0,r.jsx)(o.p,{children:"MS supports scrobbling simultaneous, different Plays based on what each Group/Zone is playing."}),"\n",(0,r.jsx)(c,{type:"tip",summary:"Use Musicbrainz for better scrobbling",children:(0,r.jsxs)(o.p,{children:["For some services, including Spotify, Sonos only reports the ",(0,r.jsx)(o.strong,{children:"first"})," artist for a Track. You will most likely want to enable ",(0,r.jsx)(o.a,{href:"/configuration/transforms/musicbrainz",children:"Musicbrainz scrobble enhancements"})," so that your plays have correct information, including all artists, when scrobbled."]})}),"\n",(0,r.jsxs)(c,{type:"note",summary:"Avoid Sonos activity through other Sources",children:[(0,r.jsxs)(o.p,{children:["Activity reporting for ",(0,r.jsxs)(o.strong,{children:["other ",(0,r.jsx)(o.a,{href:"/configuration/sources",children:"Sources"})]})," does not work well ",(0,r.jsx)(o.strong,{children:"when played through Sonos."})]}),(0,r.jsxs)(o.p,{children:["If you have other Sources configured for Multi-Scrobbler that you may play ",(0,r.jsx)(o.em,{children:"through Sonos"}),' you should try to add Sonos to the "deny" list for that Source so that it does not try to monitor Sonos activity. Check the documentation for each individual Source to see how to configure this exclusion.']}),(0,r.jsxs)(o.p,{children:["For example, to prevent the ",(0,r.jsx)(o.a,{href:"/configuration/sources/plex",children:"Plex"}),' Source from monitoring audio played through Sonos, add Sonos to the "block" list ENV EX: ',(0,r.jsx)(o.code,{children:"PLEX_DEVICES_BLOCK=sonos"})]})]}),"\n",(0,r.jsxs)(n,{children:[(0,r.jsx)("summary",{children:"How to report issues"}),(0,r.jsxs)(o.p,{children:["If your Sonos Source is logging errors or the scrobble data is not as expected please ",(0,r.jsx)(o.a,{href:"https://github.com/FoxxMD/multi-scrobbler/issues/new?template=01-bug-report.yml",children:"create a bug report"})," ",(0,r.jsx)(o.strong,{children:"after"})," enabling the following debug logging options based on the config type you have:"]}),(0,r.jsxs)(i.default,{groupdId:"sonosBugConfig",children:[(0,r.jsx)(l.default,{value:"env",label:"ENV",children:(0,r.jsxs)(o.p,{children:["Enable ",(0,r.jsx)(o.a,{href:"/configuration#debug-mode",children:"Debug Mode"})," using ",(0,r.jsx)(o.code,{children:"DEBUG_MODE=true"})]})}),(0,r.jsxs)(l.default,{value:"file",label:"File",children:[(0,r.jsxs)(o.p,{children:["Enable ",(0,r.jsx)(o.code,{children:"logPayload"})," and ",(0,r.jsx)(o.code,{children:"logFitlerFailure"})," in your ",(0,r.jsx)(o.code,{children:"sonos.json"}),", or AIO file, config:"]}),(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-json",children:'[\n  {\n    "enable": true,\n    "name": "MySonos",\n    "data": {\n      "host": "192.168.0.150"\n    },\n    "options": {\n      "logFilterFailure":  "warn",\n      "logPayload": true\n     }\n  }\n]\n'})})]})]}),(0,r.jsx)(o.p,{children:"Additional logging for the Sonos library may be enabled by including this environmental variable (regardless of config type):"}),(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"DEBUG=sonos:*\n"})}),(0,r.jsx)(o.p,{children:"The above changes:"}),(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsx)(o.li,{children:"Triggers multi-scrobbler to log the raw data recieved from Sonos when a new track/device/service is seen for the first time"}),"\n",(0,r.jsx)(o.li,{children:"Trigger multi-scrobbler to log the reason it considers a play from Sonos as invalid (and will not monitor it)"}),"\n",(0,r.jsx)(o.li,{children:"Logs low-level activity from the Sonos library"}),"\n"]}),(0,r.jsx)(o.p,{children:"Please include these additional logs when creating a bug report. They are essential to troubleshooting your issue."})]}),"\n",(0,r.jsx)(o.h3,{id:"filtering-activity",children:"Filtering Activity"}),"\n",(0,r.jsxs)(o.p,{children:["The ",(0,r.jsx)(o.strong,{children:"optional"})," ",(0,r.jsx)(o.code,{children:"devices"})," and ",(0,r.jsx)(o.code,{children:"groups"})," related properties found in the config below can be used to include or exclude Sonos devices/groups by name, case-insensitive."]}),"\n",(0,r.jsx)(o.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsxs)(o.p,{children:["You ",(0,r.jsx)(o.strong,{children:"must"})," define the IP address of at least one Sonos/accessory in order for Multi-scrobbler to connect to your Sonos system."]}),"\n",(0,r.jsx)(s,{config:"SonosSourceConfig",fileContent:'[\n  {\n    "enable": true,\n    "name": "MySonos",\n    "data": {\n      "host": "192.168.0.150",\n      "devicesAllow": ["move","beam"],\n      "devicesBlock": ["roam"],\n      "groupsAllow": ["family"],\n      "groupsBlock": ["bedroom"]\n    }\n  }\n]\n',name:"sonos",children:(0,r.jsxs)(o.table,{children:[(0,r.jsx)(o.thead,{children:(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.th,{children:"Environmental Variable"}),(0,r.jsx)(o.th,{children:"Required?"}),(0,r.jsx)(o.th,{children:"Default"}),(0,r.jsx)(o.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,r.jsxs)(o.tbody,{children:[(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:(0,r.jsx)(o.code,{children:"SONOS_HOST"})}),(0,r.jsx)(o.td,{children:"Yes"}),(0,r.jsx)(o.td,{}),(0,r.jsxs)(o.td,{style:{textAlign:"left"},children:["The IP address of any active Sonos device/accessory EX ",(0,r.jsx)(o.code,{children:"192.168.0.150"})]})]}),(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:(0,r.jsx)(o.code,{children:"SONOS_DEVICES_ALLOW"})}),(0,r.jsx)(o.td,{children:"No"}),(0,r.jsx)(o.td,{}),(0,r.jsx)(o.td,{style:{textAlign:"left"},children:"Comma-separated list of Sonos device names to scrobble from"})]}),(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:(0,r.jsx)(o.code,{children:"SONOS_DEVICES_BLOCK"})}),(0,r.jsx)(o.td,{children:"No"}),(0,r.jsx)(o.td,{}),(0,r.jsx)(o.td,{style:{textAlign:"left"},children:"Comma-separated list of Sonos device names to disallow scrobbles from"})]}),(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:(0,r.jsx)(o.code,{children:"SONOS_GROUPS_ALLOW"})}),(0,r.jsx)(o.td,{children:"No"}),(0,r.jsx)(o.td,{}),(0,r.jsx)(o.td,{style:{textAlign:"left"},children:"Comma-separated list of device group names to scrobble from"})]}),(0,r.jsxs)(o.tr,{children:[(0,r.jsx)(o.td,{children:(0,r.jsx)(o.code,{children:"SONOS_GROUPS_BLOCK"})}),(0,r.jsx)(o.td,{children:"No"}),(0,r.jsx)(o.td,{}),(0,r.jsx)(o.td,{style:{textAlign:"left"},children:"Comma-separated list of devices group names to disallow scrobbles from"})]})]})]})})]})}function x(e={}){let{wrapper:o}={...(0,t.a)(),...e.components};return o?(0,r.jsx)(o,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}function g(e,o){throw Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}}}]);